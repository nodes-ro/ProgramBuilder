<!doctype html>
<html data-theme="light" lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Event Program Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css" rel="stylesheet"/>


</head>
<body class="container">


<main>
    <h1>Event Program Generator</h1>

    {%- with msgs = get_flashed_messages(with_categories=true) %}
        {%- if msgs %}
            {%- for cat, msg in msgs %}
        <article class="alert {{ cat }}">{{ msg }}</article>
            {%- endfor %}
        {%- endif %}
    {%- endwith %}

    <!-- Split view: 1/3 wizard · 2/3 schedule -->
    <div class="grid" style="grid-template-columns: 1fr 2fr; gap: var(--pico-spacing);">

   <aside>

    <!-- Accordion 1: Create New Program -->
  <details {% if active_program_id %}disabled{% endif %} open>
    <summary><h4>Create Program</h4></summary>

    {% if active_program_id %}
        <p><em>A program is already active. You can add days and events to it.</em></p>
    {% else %}
        <form method="post">
            <input type="hidden" name="form_type" value="new_program">
            <label>Program name
                <input name="program_name" placeholder="e.g. 2025 Tech Festival" required type="text"/>
            </label>
            <button class="secondary" type="submit">Create Program</button>
        </form>
    {% endif %}
</details>


    <!-- Accordion 2: Create Day -->
    <details>
        <summary><h4>Create Day</h4></summary>
        <form method="post">
            <input type="hidden" name="form_type" value="day_schedule">

            <label>Select Program
                <select name="program_id" required>
                    {% for program in programs %}
                    <option value="{{ program.id }}">{{ program.name }}</option>
                    {% endfor %}
                </select>
            </label>

            <label for="day">Day</label>
            <select name="day" id="day" required>
                <option value="" disabled selected>Select a day</option>
                {% for d in days %}
                    <option value="{{ d }}">{{ d }}</option>
                {% endfor %}
            </select>

            <div class="grid" style="grid-template-columns: 1fr 1fr; gap: var(--pico-spacing);">
                <label for="day_start">Day starts
                    <input id="day_start" name="day_start" required type="time"/>
                </label>
                <label for="day_ends">Day ends
                    <input id="day_ends" name="day_ends" required type="time"/>
                </label>
            </div>

            <button class="secondary" type="submit">Save Day</button>
        </form>
    </details>

    <!-- Accordion 3: Add Events to Program -->
    <details>
        <summary><h4>Add Events to Program</h4></summary>
        <form enctype="multipart/form-data" method="post">
            <input type="hidden" name="form_type" value="new_event">

            <label>Select Program
                <select name="program_id" required>
                    {% for program in programs %}
                    <option value="{{ program.id }}">{{ program.name }}</option>
                    {% endfor %}
                </select>
            </label>

            <label>Select Day
                <select name="day" required>
                    {% for d in days %}
                    <option value="{{ d }}">{{ d }}</option>
                    {% endfor %}
                </select>
            </label>

            <label>Event title
                <input name="title" placeholder="Event title" required type="text"/>
            </label>

            <label>Event description
                <textarea maxlength="240" name="detail" placeholder="What happens? (max 240 chars)" required rows="2"></textarea>
            </label>

            <label>Event picture (optional)
                <input accept="image/*" name="picture" type="file"/>
            </label>

            <label>Event starts at
                <input name="event_start" required type="time"/>
            </label>

            <label>Event ends at
                <input name="event_ends" required type="time"/>
            </label>

            <label>Stage (optional)
                <input name="stage" placeholder="Stage name (e.g. Main, Workshop)" type="text"/>
            </label>

            <button class="secondary" type="submit">Add Event</button>
        </form>
    </details>

</aside>


        <!-- ────────── 2. SCHEDULE (right‑two‑thirds) ────────── -->
        <section style="display:flex;flex-direction:column;align-items:center;">
            {% include "program_template.html" %}
        </section>
    </div>
</main>
</body>
</html>
