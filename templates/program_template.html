{% if program %}
<h3>{{ program.name }}</h3>

<!-- Tab container -->
<div class="tabs">
  <!-- Tab Navigation -->
  <nav role="tablist">
    <ul>
      {% for day in program.days %}
      {% set tab_id = day.day | lower | replace(" ", "_") %}
      <li><a href="#{{ tab_id }}" role="tab" {% if loop.first %}class="active"{% endif %}>{{ day.day }}</a></li>
      {% endfor %}
    </ul>
  </nav>

  <!-- Tab Content Sections -->
  {% for day in program.days %}
  {% set tab_id = day.day | lower | replace(" ", "_") %}
  {% set start_hour = day.day_start.split(':')[0] | int %}
  {% set end_hour = day.day_ends.split(':')[0] | int %}
  {% set stage_count = day.stage_count | int %}

  <section id="{{ tab_id }}" role="tabpanel" {% if not loop.first %}style="display:none;"{% endif %}>
    <h4>{{ day.day }}</h4>

    <table>
      <thead>
        <tr>
          <th>Time</th>
          {% for stage in range(1, stage_count + 1) %}
          <th>Stage {{ stage }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for hour in range(start_hour, end_hour) %}
        <tr>
          <td>{{ "%02d:00" % hour }}</td>
          {% for _ in range(stage_count) %}
          <td></td>
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
  {% endfor %}
</div>

<!-- JS for tab switching -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const tabs = document.querySelectorAll("nav[role=tablist] a");
    const panels = document.querySelectorAll("section[role=tabpanel]");

    tabs.forEach(tab => {
      tab.addEventListener("click", e => {
        e.preventDefault();

        const targetId = tab.getAttribute("href").substring(1);

        // Hide all panels
        panels.forEach(panel => panel.style.display = "none");

        // Remove active class from all tabs
        tabs.forEach(t => t.classList.remove("active"));

        // Show the selected panel
        document.getElementById(targetId).style.display = "block";

        // Mark the clicked tab as active
        tab.classList.add("active");
      });
    });
  });
</script>

<!-- Optional CSS for active tab styling -->
<style>
  nav[role=tablist] a.active {
    font-weight: bold;
    border-bottom: 2px solid currentColor;
  }
</style>
{% else %}
<p>No program yet.</p>
{% endif %}
